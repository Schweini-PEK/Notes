\begin{Verbatim}[commandchars=\\\{\}]
    \PYG{n}{A} \PYG{p}{=} \PYG{n+nb}{randn}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{o}{*}\PYG{n+nb}{diag}\PYG{p}{(.}\PYG{l+m+mf}{5.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{50}\PYG{p}{))}\PYG{o}{*}\PYG{n+nb}{randn}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{);[}\PYG{n}{Q}\PYG{p}{,}\PYG{n}{R}\PYG{p}{,}\PYG{n}{P}\PYG{p}{]=}\PYG{n}{qr}\PYG{p}{(}\PYG{n}{A}\PYG{p}{);}\PYG{n}{r}\PYG{p}{=}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n+nb}{diag}\PYG{p}{(}\PYG{n}{R}\PYG{p}{));}\PYG{n}{s}\PYG{p}{=}\PYG{n}{svd}\PYG{p}{(}\PYG{n}{A}\PYG{p}{);}
    \PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{),}\PYG{n}{semilogy}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{n}{r}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}r\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{n}{s}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}k\PYGZsq{}}\PYG{p}{),}\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}red = diag(r), black = svd\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{),}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{r}\PYG{o}{./}\PYG{n}{s}\PYG{p}{),}\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}diag(r)/svd\PYGZsq{}}\PYG{p}{),} \PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{),} \PYG{n}{spy}\PYG{p}{(}\PYG{n}{P}\PYG{p}{)}
\end{Verbatim}
