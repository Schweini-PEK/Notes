\begin{Verbatim}[commandchars=\\\{\}]
    \PYG{n}{cs} \PYG{p}{=} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n+nb}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{);} \PYG{n}{sn} \PYG{p}{=} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n+nb}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{);} \PYG{n}{n}\PYG{p}{=}\PYG{l+m+mi}{30}\PYG{p}{;}
    \PYG{n}{S} \PYG{p}{=} \PYG{n+nb}{diag}\PYG{p}{(}\PYG{n}{sn}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{n}{n}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{));} \PYG{n}{C} \PYG{p}{=} \PYG{n+nb}{eye}\PYG{p}{(}\PYG{n}{n}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{cs}\PYG{o}{*}\PYG{n+nb}{triu}\PYG{p}{(}\PYG{n+nb}{ones}\PYG{p}{(}\PYG{n}{n}\PYG{p}{,}\PYG{n}{n}\PYG{p}{),}\PYG{l+m+mi}{1}\PYG{p}{);} \PYG{n}{D} \PYG{p}{=} \PYG{n+nb}{diag}\PYG{p}{(.}\PYG{l+m+mf}{9999.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{n}{n}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{));}
    \PYG{n}{A} \PYG{p}{=} \PYG{n}{S}\PYG{o}{*}\PYG{n}{C}\PYG{o}{*}\PYG{n}{D}\PYG{p}{;} \PYG{p}{[}\PYG{n}{Q}\PYG{p}{,}\PYG{n}{R}\PYG{p}{,}\PYG{n}{P}\PYG{p}{]=}\PYG{n}{qr}\PYG{p}{(}\PYG{n}{A}\PYG{p}{);}\PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{),}\PYG{n}{spy}\PYG{p}{(}\PYG{n}{P}\PYG{p}{);}\PYG{n}{pause}\PYG{p}{,} \PYG{n}{r}\PYG{p}{=}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n+nb}{diag}\PYG{p}{(}\PYG{n}{R}\PYG{p}{));}\PYG{n}{s}\PYG{p}{=}\PYG{n}{svd}\PYG{p}{(}\PYG{n}{A}\PYG{p}{);}
    \PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{),}\PYG{n}{semilogy}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{n}\PYG{p}{,}\PYG{n}{r}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}r+\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{n}\PYG{p}{,}\PYG{n}{s}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}k+\PYGZhy{}\PYGZsq{}}\PYG{p}{),}\PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}red = diag(R), black = svd\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{figure}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{),}\PYG{n}{semilogy}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{n}\PYG{p}{,}\PYG{n}{r}\PYG{o}{./}\PYG{n}{s}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}k+\PYGZhy{}\PYGZsq{}}\PYG{p}{),} \PYG{n}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}diag(r)/svd\PYGZsq{}}\PYG{p}{)}
\end{Verbatim}
